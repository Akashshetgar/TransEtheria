{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\akash\\\\music-app-bc\\\\frontend\\\\src\\\\context\\\\TransactionContext.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { ethers } from 'ethers';\nimport { contractABI, contractAddress } from \"../utilities/constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const TransactionContext = /*#__PURE__*/React.createContext();\nconst {\n  ethereum\n} = window;\n\nconst createEthereumContract = () => {\n  const provider = new ethers.providers.Web3Provider(ethereum);\n  const signer = provider.getSigner();\n  const transactionsContract = new ethers.Contract(contractAddress, contractABI, signer); // console.log({provider, signer, transactionsContract});\n\n  return transactionsContract;\n};\n\nexport const TransactionsProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [currentAccount, setCurrentAccount] = useState(\"\");\n  const [formData, setFormData] = useState({\n    addressTo: \"\",\n    amount: \"\",\n    keyword: \"\",\n    message: \"\"\n  });\n\n  function handleChange(event, name) {\n    setFormData(prevState => ({ ...prevState,\n      [name]: event.target.value\n    })); // var k = {...prevState};\n    // k[name] = event.target.value;\n    // console.log(prevState);\n    // setFormData(k);\n  }\n\n  const CheckIfWalletIsConnected = async () => {\n    try {\n      if (!ethereum) return alert(\"Please install MetaMask\");\n      const accounts = await ethereum.request({\n        method: 'eth_accounts'\n      });\n\n      if (accounts.length) {\n        setCurrentAccount(accounts[0]);\n      } else {\n        console.log(\"No accounts found!\");\n      }\n    } catch (err) {\n      console.log(err);\n      throw new Error('No ethereum object');\n    }\n  };\n\n  const connectWallet = async () => {\n    try {\n      if (!ethereum) return alert(\"Please install MetaMask\");\n      const accounts = await ethereum.request({\n        method: 'eth_requestAccounts'\n      });\n      setCurrentAccount(accounts[0]);\n    } catch (error) {\n      console.log(error);\n      throw new Error('No ethereum object');\n    }\n  };\n\n  const sendTransaction = async () => {\n    try {\n      if (!ethereum) return alert(\"Please install MetaMask\");\n      const {\n        addressTo,\n        amount,\n        message,\n        keyword\n      } = formData;\n      const transactionContract = createEthereumContract();\n      const parsedAmt = ethers.utils.parseEther(amount);\n      await ethereum.request({\n        method: 'eth_sendTransaction',\n        params: [{\n          from: currentAccount,\n          to: addressTo,\n          gas: '0x5208',\n          value: parsedAmt._hex\n        }]\n      });\n      const transactionHash = await transactionContract.add(addressTo, message, parsedAmt, keyword);\n    } catch (err) {\n      console.log(err);\n      throw new Error('No ethereum object');\n    }\n  };\n\n  useEffect(() => {\n    CheckIfWalletIsConnected();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(TransactionContext.Provider, {\n    value: {\n      connectWallet,\n      currentAccount,\n      sendTransaction,\n      formData,\n      handleChange,\n      setFormData\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 5\n  }, this); // const [formData, setformData] = useState({ addressTo: \"\", amount: \"\", keyword: \"\", message: \"\" });\n  // const [currentAccount, setCurrentAccount] = useState(\"\");\n  // const [isLoading, setIsLoading] = useState(false);\n  // const [transactionCount, setTransactionCount] = useState(localStorage.getItem(\"transactionCount\"));\n  // const [transactions, setTransactions] = useState([]);\n  // const handleChange = (e, name) => {\n  //   setformData((prevState) => ({ ...prevState, [name]: e.target.value }));\n};\n\n_s(TransactionsProvider, \"UmvVz+I9Jy287/T1Z0eJhQFWADs=\");\n\n_c = TransactionsProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"TransactionsProvider\");","map":{"version":3,"sources":["C:/Users/akash/music-app-bc/frontend/src/context/TransactionContext.jsx"],"names":["React","useEffect","useState","ethers","contractABI","contractAddress","TransactionContext","createContext","ethereum","window","createEthereumContract","provider","providers","Web3Provider","signer","getSigner","transactionsContract","Contract","TransactionsProvider","children","currentAccount","setCurrentAccount","formData","setFormData","addressTo","amount","keyword","message","handleChange","event","name","prevState","target","value","CheckIfWalletIsConnected","alert","accounts","request","method","length","console","log","err","Error","connectWallet","error","sendTransaction","transactionContract","parsedAmt","utils","parseEther","params","from","to","gas","_hex","transactionHash","add"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\r\nimport {ethers} from 'ethers';\r\nimport { contractABI, contractAddress } from \"../utilities/constants\";\r\n\r\nexport const TransactionContext = React.createContext();\r\nconst { ethereum } = window;\r\n\r\nconst createEthereumContract = () => {\r\n    const provider = new ethers.providers.Web3Provider(ethereum);\r\n    const signer = provider.getSigner();\r\n    const transactionsContract = new ethers.Contract(contractAddress, contractABI, signer);\r\n  \r\n    // console.log({provider, signer, transactionsContract});\r\n    return transactionsContract;\r\n  };\r\n\r\n  export const TransactionsProvider = ({ children }) => {\r\n\r\n    const [currentAccount, setCurrentAccount] = useState(\"\");\r\n    const [formData, setFormData] = useState({addressTo:\"\",amount:\"\",keyword:\"\",message:\"\"});\r\n    \r\n\r\n    function handleChange(event,name){\r\n        setFormData(prevState=>({...prevState,[name]:event.target.value}));\r\n        // var k = {...prevState};\r\n        // k[name] = event.target.value;\r\n        // console.log(prevState);\r\n        // setFormData(k);\r\n    }\r\n\r\n    const CheckIfWalletIsConnected = async ()=>{\r\n\r\n        try{\r\n\r\n            if(!ethereum) return alert(\"Please install MetaMask\");\r\n    \r\n            const accounts = await ethereum.request({method: 'eth_accounts'});\r\n    \r\n            if(accounts.length){\r\n                setCurrentAccount(accounts[0]);\r\n            }else{\r\n                console.log(\"No accounts found!\");\r\n            }\r\n        }\r\n        catch(err){\r\n            console.log(err);\r\n            throw new Error('No ethereum object');\r\n        }\r\n    }\r\n\r\n    const connectWallet = async ()=>{\r\n        try{\r\n            if(!ethereum) return alert(\"Please install MetaMask\");\r\n            const accounts = await ethereum.request({method: 'eth_requestAccounts'});\r\n            setCurrentAccount(accounts[0]);\r\n        }catch(error){\r\n            console.log(error);\r\n            throw new Error('No ethereum object');\r\n\r\n        }\r\n    }\r\n\r\n    const sendTransaction = async ()=>{\r\n        try{\r\n            if(!ethereum) return alert(\"Please install MetaMask\");\r\n            const {addressTo,amount,message,keyword} = formData;\r\n            const transactionContract = createEthereumContract();\r\n            const parsedAmt = ethers.utils.parseEther(amount);\r\n            await ethereum.request({\r\n                method:'eth_sendTransaction',\r\n                params:[{\r\n                    from:currentAccount,\r\n                    to:addressTo,\r\n                    gas:'0x5208',\r\n                    value:parsedAmt._hex,\r\n                }]\r\n            });\r\n            const transactionHash = await transactionContract.add(addressTo,message,parsedAmt,keyword);\r\n\r\n        }catch(err){\r\n            console.log(err);\r\n            throw new Error('No ethereum object');\r\n        }\r\n    }\r\n    useEffect(()=>{\r\n        CheckIfWalletIsConnected();\r\n    },[])\r\n\r\n\r\n    return(\r\n    <TransactionContext.Provider  value={{ connectWallet, currentAccount, sendTransaction, formData, handleChange, setFormData}}>\r\n        {children}\r\n    </TransactionContext.Provider>\r\n    );\r\n    // const [formData, setformData] = useState({ addressTo: \"\", amount: \"\", keyword: \"\", message: \"\" });\r\n    // const [currentAccount, setCurrentAccount] = useState(\"\");\r\n    // const [isLoading, setIsLoading] = useState(false);\r\n    // const [transactionCount, setTransactionCount] = useState(localStorage.getItem(\"transactionCount\"));\r\n    // const [transactions, setTransactions] = useState([]);\r\n  \r\n    // const handleChange = (e, name) => {\r\n    //   setformData((prevState) => ({ ...prevState, [name]: e.target.value }));\r\n    };"]},"metadata":{},"sourceType":"module"}